public System.Web.Mvc.ContentResult ExportByApi(Context context)
{
    SetSite(context: context);
    if (!WithinApiLimits(context: context, siteModel: Site))
    {
        return ApiResults.Get(ApiResponses.OverLimitApi(
            context: context,
            siteId: Site.SiteId,
            limitPerSite: Parameters.Api.LimitPerSite));
    }
    switch (Site.ReferenceType)
    {
        case "Issues":
            if (SiteId == ReferenceId)
            {
                return IssueUtilities.ExportByApi(
                    context: context,
                    ss: Site.IssuesSiteSettings(
                        context: context,
                        referenceId: ReferenceId),
                    siteModel: Site);
            }
            break;
        case "Results":
            if (SiteId == ReferenceId)
            {
                return ResultUtilities.ExportByApi(
                    context: context,
                    ss: Site.ResultsSiteSettings(
                        context: context,
                        referenceId: ReferenceId),
                    siteModel: Site);
            }
            break;
        default:
            return ApiResults.Get(ApiResponses.BadRequest(context: context));
    }
    return ApiResults.Get(ApiResponses.BadRequest(context: context));
}