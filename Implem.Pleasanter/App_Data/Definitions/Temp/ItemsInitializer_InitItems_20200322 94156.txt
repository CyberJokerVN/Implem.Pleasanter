Rds.ExecuteNonQuery(
    context: context,
    statements: Rds.PhysicalDelete#TableName#(
        where: Rds.ItemsWhere().Add(raw: sqlExists.Params(
            "[#TableName#_Deleted]",
            "[#TableName#_Deleted].[#ModelName#Id]",
            "[#TableName#].[#ModelName#Id]"))));
Rds.ExecuteNonQuery(
    context: context,
    statements: Rds.Delete#TableName#(
        where: Rds.ItemsWhere().Add(raw: sqlExists.Params(
            "[Items_Deleted]",
            "[Items_Deleted].[ReferenceId]",
            "[#TableName#].[#ModelName#Id]"))));
Rds.ExecuteTable(
    context: context,
    statements: Rds.Select#TableName#(
        tableType: Sqls.TableTypes.Normal,
        column: Rds.#TableName#Column()
            .SiteId()
            .#ModelName#Id()
            .Ver()
            .Sites_TenantId(),
        join: Rds.#TableName#JoinDefault()
            .Add(
                tableName: "Items",
                joinType: SqlJoin.JoinTypes.LeftOuter,
                joinExpression: "[Items].[ReferenceId]=[#TableName#].[#ModelName#Id]")
            .Add(
                tableName: "Sites",
                joinType: SqlJoin.JoinTypes.LeftOuter,
                joinExpression: "[Sites].[SiteId]=[#TableName#].[SiteId]"),
        where: Rds.ItemsWhere()
            .ReferenceId(
                tableName: "Items",
                _operator: " is null")))
                    .AsEnumerable()
                    .ForEach(dataRow =>
                    {
                        var siteId = dataRow.Long("SiteId");
                        var ss = new SiteModel().Get(
                            context: context.CreateContext(tenantId: dataRow.Int("TenantId")),
                            where: Rds.SitesWhere().SiteId(siteId))?
                                .#TableName#SiteSettings(
                                    context: context.CreateContext(tenantId: dataRow.Int("TenantId")),
                                    referenceId: dataRow.Long("#ModelName#Id"));
                        var #modelName#Model = new #ModelName#Model(
                            context: context.CreateContext(tenantId: dataRow.Int("TenantId")),
                            ss: ss)
                                .Get(
                                    context: context.CreateContext(tenantId: dataRow.Int("TenantId")),
                                    ss: ss,
                                    tableType: Sqls.TableTypes.Normal,
                                    where: Rds.#TableName#Where()
                                        .SiteId(dataRow.Long("SiteId"))
                                        .#ModelName#Id(dataRow.Long("#ModelName#Id"))
                                        .Ver(dataRow.Int("Ver")));
                        if (ss != null &&
                            #modelName#Model.AccessStatus == Databases.AccessStatuses.Selected)
                        {
                            var fullText = #modelName#Model.FullText(
                                context: context.CreateContext(tenantId: dataRow.Int("TenantId")),
                                ss: ss);
                            Rds.ExecuteNonQuery(
                                context: context.CreateContext(tenantId: dataRow.Int("TenantId")),
                                connectionString: Parameters.Rds.OwnerConnectionString,
                                statements: new SqlStatement[]
                                {
                                    Rds.IdentityInsertItems(on: true),
                                    Rds.InsertItems(
                                        param: Rds.ItemsParam()
                                            .ReferenceId(#modelName#Model.#ModelName#Id)
                                            .ReferenceType("#TableName#")
                                            .SiteId(#modelName#Model.SiteId)
                                            .Title(#modelName#Model.Title.DisplayValue)
                                            .FullText(fullText, _using: fullText != null)
                                            .SearchIndexCreatedTime(DateTime.Now)),
                                    Rds.IdentityInsertItems(on: false)
                                });
                        }
                    });
Rds.ExecuteTable(
    context: context,
    statements: Rds.Select#TableName#(
        tableType: Sqls.TableTypes.Deleted,
        column: Rds.#TableName#Column()
            .SiteId()
            .#ModelName#Id()
            .Ver(),
        join: Rds.#TableName#JoinDefault()
            .Add(
                tableName: "Items_Deleted",
                joinType: SqlJoin.JoinTypes.LeftOuter,
                joinExpression: "[Items_Deleted].[ReferenceId]=[#TableName#].[#ModelName#Id]")
            .Add(
                tableName: "Sites",
                joinType: SqlJoin.JoinTypes.LeftOuter,
                joinExpression: "[Sites].[SiteId]=[#TableName#].[SiteId]"),
        where: Rds.ItemsWhere()
            .ReferenceId(
                tableName: "Items_Deleted",
                _operator: " is null")))
                    .AsEnumerable()
                    .ForEach(dataRow =>
                    {
                        var siteId = dataRow.Long("SiteId");
                        var ss = new SiteModel().Get(
                            context: context.CreateContext(tenantId: dataRow.Int("TenantId")),
                            where: Rds.SitesWhere().SiteId(siteId))?
                                .#TableName#SiteSettings(
                                    context: context.CreateContext(tenantId: dataRow.Int("TenantId")),
                                    referenceId: dataRow.Long("#ModelName#Id"));
                        var #modelName#Model = new #ModelName#Model(
                            context: context.CreateContext(tenantId: dataRow.Int("TenantId")),
                            ss: ss)
                                .Get(
                                    context: context.CreateContext(tenantId: dataRow.Int("TenantId")),
                                    ss: ss,
                                    tableType: Sqls.TableTypes.Deleted,
                                    where: Rds.#TableName#Where()
                                        .SiteId(dataRow.Long("SiteId"))
                                        .#ModelName#Id(dataRow.Long("#ModelName#Id"))
                                        .Ver(dataRow.Int("Ver")));
                        if (ss != null &&
                            #modelName#Model.AccessStatus == Databases.AccessStatuses.Selected)
                        {
                            Rds.ExecuteNonQuery(
                                context: context.CreateContext(tenantId: dataRow.Int("TenantId")),
                                statements: new SqlStatement[]
                                {
                                    Rds.InsertItems(
                                        tableType: Sqls.TableTypes.Deleted,
                                        param: Rds.ItemsParam()
                                            .ReferenceId(#modelName#Model.#ModelName#Id)
                                            .Ver(#modelName#Model.Ver)
                                            .ReferenceType("#TableName#")
                                            .SiteId(#modelName#Model.SiteId)
                                            .Title(#modelName#Model.Title.DisplayValue))
                                });
                        }
                    });