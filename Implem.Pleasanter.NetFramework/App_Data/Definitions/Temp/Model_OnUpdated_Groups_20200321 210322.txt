statements = new List<SqlStatement>
{
    Repository.PhysicalDeleteGroupMembers(
        where: Rds.GroupMembersWhere()
            .GroupId(GroupId))
};
context.Forms.List("CurrentMembersAll").ForEach(data =>
{
    if (data.StartsWith("Dept,"))
    {
        statements.Add(Rds.InsertGroupMembers(
            param: Rds.GroupMembersParam()
                .GroupId(GroupId)
                .DeptId(data.Split_2nd().ToInt())
                .Admin(data.Split_3rd().ToBool())));
    }
    if (data.StartsWith("User,"))
    {
        statements.Add(Rds.InsertGroupMembers(
            param: Rds.GroupMembersParam()
                .GroupId(GroupId)
                .UserId(data.Split_2nd().ToInt())
                .Admin(data.Split_3rd().ToBool())));
    }
});
Rds.ExecuteNonQuery(
    context: context,
    transactional: true,
    statements: statements.ToArray());